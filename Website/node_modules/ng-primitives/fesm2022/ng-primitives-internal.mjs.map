{"version":3,"file":"ng-primitives-internal.mjs","sources":["../../../../packages/ng-primitives/internal/src/utilities/element-ref.ts","../../../../packages/ng-primitives/internal/src/exit-animation/exit-animation-manager.ts","../../../../packages/ng-primitives/internal/src/exit-animation/exit-animation.ts","../../../../packages/ng-primitives/internal/src/signals/explicit-effect.ts","../../../../packages/ng-primitives/internal/src/style-injector/style-injector.ts","../../../../packages/ng-primitives/internal/src/utilities/resize.ts","../../../../packages/ng-primitives/internal/src/utilities/dom-removal.ts","../../../../packages/ng-primitives/internal/src/utilities/mutation-observer.ts","../../../../packages/ng-primitives/internal/src/utilities/overflow.ts","../../../../packages/ng-primitives/internal/src/utilities/scrolling.ts","../../../../packages/ng-primitives/internal/src/ng-primitives-internal.ts"],"sourcesContent":["import { ElementRef, inject } from '@angular/core';\n\n/**\n * A simple utility function to inject an element reference with less boilerplate.\n * @returns The element reference.\n */\nexport function injectElementRef<T extends HTMLElement>(): ElementRef<T> {\n  return inject(ElementRef);\n}\n","import { ClassProvider, inject, Injectable } from '@angular/core';\nimport type { NgpExitAnimation } from './exit-animation';\n\n@Injectable()\nexport class NgpExitAnimationManager {\n  /** Store the instances of the exit animation directive. */\n  private readonly instances: NgpExitAnimation[] = [];\n\n  /** Add an instance to the manager. */\n  add(instance: NgpExitAnimation): void {\n    this.instances.push(instance);\n  }\n\n  /** Remove an instance from the manager. */\n  remove(instance: NgpExitAnimation): void {\n    const index = this.instances.indexOf(instance);\n    if (index !== -1) {\n      this.instances.splice(index, 1);\n    }\n  }\n\n  /** Exit all instances. */\n  async exit(): Promise<void> {\n    await Promise.all(this.instances.map(instance => instance.exit()));\n  }\n}\n\nexport function provideExitAnimationManager(): ClassProvider {\n  return { provide: NgpExitAnimationManager, useClass: NgpExitAnimationManager };\n}\n\nexport function injectExitAnimationManager(): NgpExitAnimationManager {\n  return inject(NgpExitAnimationManager);\n}\n","import { Directive, OnDestroy } from '@angular/core';\nimport { injectElementRef } from '../utilities/element-ref';\nimport { injectExitAnimationManager } from './exit-animation-manager';\n\n@Directive({\n  selector: '[ngpExitAnimation]',\n  exportAs: 'ngpExitAnimation',\n})\nexport class NgpExitAnimation implements OnDestroy {\n  /** The animation manager. */\n  private readonly animationManager = injectExitAnimationManager();\n  /** Access the element reference. */\n  protected readonly elementRef = injectElementRef();\n\n  /** Exist animation reference. */\n  protected readonly ref = setupExitAnimation({ element: this.elementRef.nativeElement });\n\n  constructor() {\n    this.animationManager.add(this);\n  }\n\n  ngOnDestroy(): void {\n    this.animationManager.remove(this);\n  }\n\n  /** Mark the element as exiting. */\n  async exit(): Promise<void> {\n    await this.ref.exit();\n  }\n}\n\ninterface NgpExitAnimationOptions {\n  /** The element to animate. */\n  element: HTMLElement;\n}\n\nexport interface NgpExitAnimationRef {\n  /** Mark the element as exiting and wait for the animation to finish. */\n  exit: () => Promise<void>;\n}\n\nexport function setupExitAnimation({ element }: NgpExitAnimationOptions): NgpExitAnimationRef {\n  let state: 'enter' | 'exit' = 'enter';\n\n  function setState(newState: 'enter' | 'exit') {\n    state = newState;\n\n    // remove all current animation state attributes\n    element.removeAttribute('data-enter');\n    element.removeAttribute('data-exit');\n\n    // add the new animation state attribute\n    if (state === 'enter') {\n      element.setAttribute('data-enter', '');\n    } else if (state === 'exit') {\n      element.setAttribute('data-exit', '');\n    }\n  }\n\n  // Set the initial state to 'enter'\n  requestAnimationFrame(() => setState('enter'));\n\n  return {\n    exit: () => {\n      return new Promise((resolve, reject) => {\n        setState('exit');\n\n        const animations = element.getAnimations();\n\n        // Wait for the exit animations to finish\n        if (animations.length > 0) {\n          Promise.all(animations.map(anim => anim.finished))\n            .then(() => resolve())\n            .catch(err => {\n              if (err instanceof Error && err.name !== 'AbortError') {\n                return reject(err);\n              }\n              // Ignore abort errors as they are expected when the animation is interrupted\n              // by the removal of the element - e.g. when the user navigates away to another page\n              resolve();\n            });\n        } else {\n          resolve();\n        }\n      });\n    },\n  };\n}\n","/**\n * This implementation is heavily inspired by the great work on ngextension!\n * https://github.com/ngxtension/ngxtension-platform/blob/main/libs/ngxtension/explicit-effect/src/explicit-effect.ts\n */\nimport {\n  CreateEffectOptions,\n  EffectCleanupRegisterFn,\n  EffectRef,\n  effect,\n  untracked,\n} from '@angular/core';\n\n/**\n * We want to have the Tuple in order to use the types in the function signature\n */\ntype ExplicitEffectValues<T> = {\n  [K in keyof T]: () => T[K];\n};\n\n/**\n * This explicit effect function will take the dependencies and the function to run when the dependencies change.\n * @param deps - The dependencies that the effect will run on\n * @param fn - The function to run when the dependencies change\n * @param options - The options for the effect with the addition of defer (it allows the computation to run on first change, not immediately)\n */\nexport function explicitEffect<Input extends readonly unknown[], Params = Input>(\n  deps: readonly [...ExplicitEffectValues<Input>],\n  fn: (deps: Params, onCleanup: EffectCleanupRegisterFn) => void,\n  options?: CreateEffectOptions,\n): EffectRef {\n  return effect(onCleanup => {\n    const depValues = deps.map(s => s());\n    untracked(() => fn(depValues as Params, onCleanup));\n  }, options);\n}\n","import { DOCUMENT, isPlatformBrowser } from '@angular/common';\nimport { CSP_NONCE, inject, Injectable, PLATFORM_ID } from '@angular/core';\n\n/**\n * A utility service for injecting styles into the document.\n * Angular doesn't allow directives to specify styles, only components.\n * As we ship directives, occasionally we need to associate styles with them.\n * This service allows us to programmatically inject styles into the document.\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class StyleInjector {\n  /**\n   * Access the CSP nonce\n   */\n  private readonly cspNonce = inject(CSP_NONCE, { optional: true });\n\n  /**\n   * Access the document.\n   */\n  private readonly document = inject(DOCUMENT);\n\n  /**\n   * Detect the platform.\n   */\n  private readonly platformId = inject(PLATFORM_ID);\n\n  /**\n   * Store the map of style elements with their unique identifiers.\n   */\n  private readonly styleElements = new Map<string, HTMLStyleElement>();\n\n  constructor() {\n    if (isPlatformBrowser(this.platformId)) {\n      this.collectServerStyles();\n    }\n  }\n\n  /**\n   * Inject a style into the document.\n   * @param id The unique identifier for the style.\n   * @param style The style to inject.\n   */\n  add(id: string, style: string): void {\n    if (this.styleElements.has(id)) {\n      return;\n    }\n\n    const styleElement = this.document.createElement('style');\n    styleElement.setAttribute('data-ngp-style', id);\n    styleElement.textContent = style;\n\n    // If a CSP nonce is provided, set it on the style element\n    if (this.cspNonce) {\n      styleElement.setAttribute('nonce', this.cspNonce);\n    }\n\n    this.document.head.appendChild(styleElement);\n    this.styleElements.set(id, styleElement);\n  }\n\n  /**\n   * Remove a style from the document.\n   * @param id The unique identifier for the style.\n   */\n  remove(id: string): void {\n    const styleElement = this.styleElements.get(id);\n\n    if (styleElement) {\n      this.document.head.removeChild(styleElement);\n      this.styleElements.delete(id);\n    }\n  }\n\n  /**\n   * Collect any styles that were rendered by the server.\n   */\n  private collectServerStyles(): void {\n    const styleElements = this.document.querySelectorAll<HTMLStyleElement>('style[data-ngp-style]');\n\n    styleElements.forEach(styleElement => {\n      const id = styleElement.getAttribute('data-ngp-style');\n\n      if (id) {\n        this.styleElements.set(id, styleElement);\n      }\n    });\n  }\n}\n\nexport function injectStyleInjector(): StyleInjector {\n  return inject(StyleInjector);\n}\n","import { DestroyRef, effect, inject, Injector, signal, Signal, untracked } from '@angular/core';\nimport { isUndefined, safeTakeUntilDestroyed } from 'ng-primitives/utils';\nimport { Observable, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { explicitEffect } from '../signals/explicit-effect';\nimport { injectElementRef } from './element-ref';\n\ninterface NgpResizeObserverOptions {\n  /**\n   * Whether to listen for events.\n   */\n  disabled?: Signal<boolean>;\n\n  /**\n   * The injector to use when called from outside of the injector context.\n   */\n  injector?: Injector;\n}\n\n/**\n * A simple helper function to create a resize observer as an RxJS Observable.\n * @param element The element to observe for resize events.\n * @returns The resize event as an Observable.\n */\nexport function fromResizeEvent(\n  element: HTMLElement,\n  { disabled = signal(false), injector }: NgpResizeObserverOptions = {},\n): Observable<Dimensions> {\n  return new Observable(observable => {\n    // ResizeObserver may not be available in all environments, so check for its existence\n    if (isUndefined(window?.ResizeObserver)) {\n      // ResizeObserver is not available (SSR or unsupported browser)\n      // Complete the observable without emitting any values\n      observable.complete();\n      return;\n    }\n\n    let observer: ResizeObserver | null = null;\n\n    function setupOrTeardownObserver() {\n      if (disabled()) {\n        if (observer) {\n          observer.disconnect();\n          observer = null;\n        }\n        return;\n      }\n\n      if (!observer) {\n        observer = new ResizeObserver(entries => {\n          // if there are no entries, ignore the event\n          if (!entries.length) {\n            return;\n          }\n\n          // otherwise, take the first entry and emit the dimensions\n          const entry = entries[0];\n\n          let width: number, height: number;\n\n          if ('borderBoxSize' in entry) {\n            const borderSizeEntry = entry['borderBoxSize'];\n            // this may be different across browsers so normalize it\n            const borderSize = Array.isArray(borderSizeEntry)\n              ? borderSizeEntry[0]\n              : borderSizeEntry;\n\n            width = borderSize['inlineSize'];\n            height = borderSize['blockSize'];\n          } else {\n            // fallback for browsers that don't support borderBoxSize\n            width = element.offsetWidth;\n            height = element.offsetHeight;\n          }\n\n          // For inline elements, ResizeObserver may report 0,0 dimensions\n          // Use getBoundingClientRect as fallback for inline elements with zero dimensions\n          if ((width === 0 || height === 0) && getComputedStyle(element).display === 'inline') {\n            const rect = element.getBoundingClientRect();\n            width = rect.width;\n            height = rect.height;\n          }\n\n          observable.next({ width, height });\n        });\n\n        observer.observe(element);\n      }\n    }\n\n    setupOrTeardownObserver();\n\n    explicitEffect([disabled], () => setupOrTeardownObserver(), { injector });\n\n    return () => observer?.disconnect();\n  });\n}\n\n/**\n * A utility function to observe any element for resize events and return the dimensions as a signal.\n */\nexport function observeResize(elementFn: () => HTMLElement | undefined): Signal<Dimensions> {\n  const dimensions = signal<Dimensions>({ width: 0, height: 0 });\n  const injector = inject(Injector);\n  const destroyRef = inject(DestroyRef);\n\n  // store the subscription to the resize event\n  let subscription: Subscription | null = null;\n\n  effect(() => {\n    const targetElement = elementFn();\n\n    untracked(() => {\n      if (!targetElement) {\n        return;\n      }\n\n      // if we already have a subscription, unsubscribe from it\n      subscription?.unsubscribe();\n\n      // create a new subscription to the resize event\n      subscription = fromResizeEvent(targetElement, { injector })\n        .pipe(safeTakeUntilDestroyed(destroyRef))\n        .subscribe(event => dimensions.set({ width: event.width, height: event.height }));\n    });\n  });\n\n  return dimensions;\n}\n\nexport interface Dimensions {\n  width: number;\n  height: number;\n}\n\n/**\n * A simple utility to get the dimensions of an element as a signal.\n */\nexport function injectDimensions(): Signal<Dimensions> {\n  const elementRef = injectElementRef<HTMLElement>();\n  const destroyRef = inject(DestroyRef);\n  const dimensions = signal<Dimensions>({ width: 0, height: 0 });\n\n  fromResizeEvent(elementRef.nativeElement)\n    .pipe(\n      safeTakeUntilDestroyed(destroyRef),\n      map(({ width, height }) => ({ width, height })),\n    )\n    .subscribe(event => dimensions.set(event));\n\n  return dimensions;\n}\n","import { isPlatformServer } from '@angular/common';\nimport { inject, PLATFORM_ID } from '@angular/core';\nimport { safeTakeUntilDestroyed } from 'ng-primitives/utils';\nimport { fromResizeEvent } from './resize';\n\n/**\n * Whenever an element is removed from the DOM, we call the callback.\n * @param element The element to watch for removal.\n * @param callback The callback to call when the element is removed.\n */\nexport function onDomRemoval(element: HTMLElement, callback: () => void): void {\n  const platform = inject(PLATFORM_ID);\n\n  // Dont run this on the server\n  if (isPlatformServer(platform)) {\n    return;\n  }\n\n  // This is a bit of a hack, but it works. If the element dimensions become zero,\n  // it's likely that the element has been removed from the DOM.\n  fromResizeEvent(element)\n    .pipe(safeTakeUntilDestroyed())\n    .subscribe(dimensions => {\n      // we check the dimensions first to short-circuit the check as it's faster\n      if (dimensions.width === 0 && dimensions.height === 0 && !document.body.contains(element)) {\n        callback();\n      }\n    });\n}\n","import { Injector, Signal, signal } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { explicitEffect } from '../signals/explicit-effect';\n\ninterface NgpMutationObserverOptions {\n  /**\n   * Whether to listen for events.\n   */\n  disabled?: Signal<boolean>;\n  /**\n   * The injector to use when called from outside of the injector context.\n   */\n  injector?: Injector;\n  /**\n   * Whether the childList should be observed.\n   */\n  childList?: boolean;\n  /**\n   * Whether the subtree should be observed.\n   */\n  subtree?: boolean;\n  /**\n   * Whether the attributes should be observed.\n   */\n  attributes?: boolean;\n  /**\n   * Whether the characterData should be observed.\n   */\n  characterData?: boolean;\n  /**\n   * Whether the attributeFilter should be observed.\n   */\n  attributeFilter?: string[];\n}\n\n/**\n * This function sets up a mutation observer to listen for changes in the DOM.\n * It will stop listening when the `disabled` signal is true, and re-enable when it is false.\n * @param options - Options for the mutation observer\n */\nexport function fromMutationObserver(\n  element: HTMLElement,\n  {\n    childList,\n    subtree,\n    attributes,\n    characterData,\n    disabled = signal(false),\n    injector,\n  }: NgpMutationObserverOptions = {},\n): Observable<MutationRecord[]> {\n  return new Observable<MutationRecord[]>(observable => {\n    let observer: MutationObserver | null = null;\n\n    function setupOrTeardownObserver() {\n      if (disabled()) {\n        if (observer) {\n          observer.disconnect();\n          observer = null;\n        }\n        return;\n      }\n\n      observer = new MutationObserver(mutations => observable.next(mutations));\n      observer.observe(element, { childList, subtree, attributes, characterData });\n    }\n\n    setupOrTeardownObserver();\n\n    // any time the disabled state changes, we need to re-evaluate the observer\n    explicitEffect([disabled], () => setupOrTeardownObserver(), { injector });\n\n    return () => observer?.disconnect();\n  });\n}\n","import { DestroyRef, inject, Injector, Signal, signal } from '@angular/core';\nimport { safeTakeUntilDestroyed } from 'ng-primitives/utils';\nimport { merge } from 'rxjs';\nimport { fromMutationObserver } from './mutation-observer';\nimport { fromResizeEvent } from './resize';\n\ninterface NgpOverflowListenerOptions {\n  /**\n   * Whether to listen for overflow changes.\n   */\n  disabled?: Signal<boolean>;\n  /**\n   * The injector to use when called from outside of the injector context.\n   */\n  injector?: Injector;\n}\n\nexport function setupOverflowListener(\n  element: HTMLElement,\n  { disabled = signal(false), injector }: NgpOverflowListenerOptions,\n): Signal<boolean> {\n  const hasOverflow = signal<boolean>(false);\n  const destroyRef = injector?.get(DestroyRef) ?? inject(DestroyRef);\n\n  // Merge both observables and update hasOverflow on any event\n\n  merge(\n    fromResizeEvent(element, { disabled, injector }),\n    fromMutationObserver(element, { disabled, injector, characterData: true }),\n  )\n    .pipe(safeTakeUntilDestroyed(destroyRef))\n    .subscribe(() =>\n      hasOverflow.set(\n        element.scrollWidth > element.clientWidth || element.scrollHeight > element.clientHeight,\n      ),\n    );\n\n  return hasOverflow;\n}\n","function getScrollableAncestor(element: HTMLElement): HTMLElement | null {\n  let parent = element.parentElement;\n  while (parent) {\n    const style = window.getComputedStyle(parent);\n    if (/(auto|scroll)/.test(style.overflowY) || /(auto|scroll)/.test(style.overflowX)) {\n      return parent;\n    }\n    parent = parent.parentElement;\n  }\n  return null;\n}\n\nexport function scrollIntoViewIfNeeded(element: HTMLElement): void {\n  const scrollableAncestor = getScrollableAncestor(element);\n  if (!scrollableAncestor) return;\n\n  const parentRect = scrollableAncestor.getBoundingClientRect();\n  const elementRect = element.getBoundingClientRect();\n\n  if (elementRect.top < parentRect.top) {\n    scrollableAncestor.scrollTop -= parentRect.top - elementRect.top;\n  } else if (elementRect.bottom > parentRect.bottom) {\n    scrollableAncestor.scrollTop += elementRect.bottom - parentRect.bottom;\n  }\n\n  if (elementRect.left < parentRect.left) {\n    scrollableAncestor.scrollLeft -= parentRect.left - elementRect.left;\n  } else if (elementRect.right > parentRect.right) {\n    scrollableAncestor.scrollLeft += elementRect.right - parentRect.right;\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}